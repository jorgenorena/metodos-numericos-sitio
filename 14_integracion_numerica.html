<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Integrales Numéricas – Métodos Numéricos y Probabilidades 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9eb995e8644016eb670a0cb3bf478a26.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Métodos Numéricos y Probabilidades 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Buscar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Inicio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">Acerca de</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-unidad-1" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Unidad 1</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-unidad-1">    
        <li>
    <a class="dropdown-item" href="./01_funcionamiento_cpu.html">
 <span class="dropdown-text">Funcionamiento de la CPU</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02_python.html">
 <span class="dropdown-text">Repaso de Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./03_numpy_arrays.html">
 <span class="dropdown-text">Repaso de numpy, matplotlib, archivos</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./04_numeros_y_condicionamiento.html">
 <span class="dropdown-text">Representación de números y condicionamiento</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./05_algoritmos_y_estabilidad.html">
 <span class="dropdown-text">Algoritmos y estabilidad</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-unidad-2" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Unidad 2</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-unidad-2">    
        <li>
    <a class="dropdown-item" href="./06_definicion_probabilidad.html">
 <span class="dropdown-text">Propiedades de la probabilidad</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./07_distribuciones.html">
 <span class="dropdown-text">Distribuciones de probabilidad</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./08_varias_variables_aleatorias.html">
 <span class="dropdown-text">Varias variables aleatorias</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./09_teorema_central_del_limite.html">
 <span class="dropdown-text">Teorema central del límite</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./10_entropia.html">
 <span class="dropdown-text">Entropía de Shannon</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-unidad-3" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Unidad 3</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-unidad-3">    
        <li>
    <a class="dropdown-item" href="./11_solucion_sistemas_lineales.html">
 <span class="dropdown-text">Solución de Sistemas de Ecuaciones Lineales</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./12_newton_y_biseccion.html">
 <span class="dropdown-text">Solución de Ecuaciones No Lineales</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./13_interpolacion.html">
 <span class="dropdown-text">Interpolación</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./14_integracion_numerica.html">
 <span class="dropdown-text">Integración Numérica</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./15_integrales_multiples_impropias_y_gauss.html">
 <span class="dropdown-text">Quadratura de Gauss, integrales múltiples e impropias</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./16_derivadas.html">
 <span class="dropdown-text">Derivadas numéricas</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-unidad-4" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Unidad 4</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-unidad-4">    
        <li>
    <a class="dropdown-item" href="./17_metodos_de_taylor.html">
 <span class="dropdown-text">Métodos de Taylor</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./18_runge_kutta.html">
 <span class="dropdown-text">Métodos de Runge-Kutta</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./19_metodos_de_multiples_pasos.html">
 <span class="dropdown-text">Métodos de Múltiples Pasos</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./20_edo_alto_orden_estabilidad.html">
 <span class="dropdown-text">Ecuaciones de alto orden y estabilidad</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-unidad-5" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Unidad 5</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-unidad-5">    
        <li>
    <a class="dropdown-item" href="./21_ajuste_de_curvas.html">
 <span class="dropdown-text">Ajustes de mínimos cuadrados</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./22_descenso_de_gradiente.html">
 <span class="dropdown-text">Descenso de gradiente</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./23_redes_neuronales.html">
 <span class="dropdown-text">Redes neuronales</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./24_integracion_monte_carlo.html">
 <span class="dropdown-text">Integración de Monte Carlo</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./25_transformada_de_fourier.html">
 <span class="dropdown-text">Transformada de Fourier</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./11_solucion_sistemas_lineales.html">Unidad 3: Cálculo Numérico</a></li><li class="breadcrumb-item"><a href="./14_integracion_numerica.html">Integración Numérica</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Unidad 1: Introducción</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_funcionamiento_cpu.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Funcionamiento de la CPU</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Repaso de Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_numpy_arrays.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Repaso de numpy, matplotlib, archivos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_numeros_y_condicionamiento.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Representación de números y condicionamiento</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_algoritmos_y_estabilidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Algoritmos y estabilidad</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Unidad 2: Probabilidad</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_definicion_probabilidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Propiedades de la probabilidad</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_distribuciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Distribuciones de probabilidad</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_varias_variables_aleatorias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Varias variables aleatorias</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_teorema_central_del_limite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Teorema central del límite</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_entropia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Entropía de Shannon</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Unidad 3: Cálculo Numérico</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_solucion_sistemas_lineales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solución de Sistemas de Ecuaciones Lineales</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_newton_y_biseccion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solución de Ecuaciones No Lineales</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_interpolacion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interpolación</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_integracion_numerica.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Integración Numérica</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_integrales_multiples_impropias_y_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quadratura de Gauss, integrales múltiples e impropias</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_derivadas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Derivadas numéricas</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Unidad 4: Ecuaciones Diferenciales</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_metodos_de_taylor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Métodos de Taylor</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18_runge_kutta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Métodos de Runge-Kutta</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19_metodos_de_multiples_pasos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Métodos de Múltiples Pasos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20_edo_alto_orden_estabilidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ecuaciones de alto orden y estabilidad</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Unidad 5: Tópicos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21_ajuste_de_curvas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ajustes de mínimos cuadrados</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22_descenso_de_gradiente.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Descenso de gradiente</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23_redes_neuronales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Redes neuronales</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24_integracion_monte_carlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Integración de Monte Carlo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25_transformada_de_fourier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transformada de Fourier</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#integrales-de-polinomios-interpolantes" id="toc-integrales-de-polinomios-interpolantes" class="nav-link active" data-scroll-target="#integrales-de-polinomios-interpolantes">Integrales de polinomios interpolantes</a></li>
  <li><a href="#integrales-compuestas" id="toc-integrales-compuestas" class="nav-link" data-scroll-target="#integrales-compuestas">Integrales compuestas</a>
  <ul class="collapse">
  <li><a href="#estabilidad-de-los-métodos-por-polinomios-interpolantes" id="toc-estabilidad-de-los-métodos-por-polinomios-interpolantes" class="nav-link" data-scroll-target="#estabilidad-de-los-métodos-por-polinomios-interpolantes">Estabilidad de los métodos por polinomios interpolantes</a></li>
  </ul></li>
  <li><a href="#métodos-de-paso-variable" id="toc-métodos-de-paso-variable" class="nav-link" data-scroll-target="#métodos-de-paso-variable">Métodos de paso variable</a>
  <ul class="collapse">
  <li><a href="#método-de-cuadratura-adaptativa" id="toc-método-de-cuadratura-adaptativa" class="nav-link" data-scroll-target="#método-de-cuadratura-adaptativa">Método de cuadratura adaptativa</a></li>
  </ul></li>
  <li><a href="#tareas" id="toc-tareas" class="nav-link" data-scroll-target="#tareas">¡Tareas!</a>
  <ul class="collapse">
  <li><a href="#tarea-7.1" id="toc-tarea-7.1" class="nav-link" data-scroll-target="#tarea-7.1">Tarea 7.1</a></li>
  <li><a href="#tarea-7.2" id="toc-tarea-7.2" class="nav-link" data-scroll-target="#tarea-7.2">Tarea 7.2</a></li>
  <li><a href="#tarea-7.3" id="toc-tarea-7.3" class="nav-link" data-scroll-target="#tarea-7.3">Tarea 7.3</a></li>
  <li><a href="#tarea-7.4" id="toc-tarea-7.4" class="nav-link" data-scroll-target="#tarea-7.4">Tarea 7.4</a></li>
  <li><a href="#tarea-7.5" id="toc-tarea-7.5" class="nav-link" data-scroll-target="#tarea-7.5">Tarea 7.5</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./11_solucion_sistemas_lineales.html">Unidad 3: Cálculo Numérico</a></li><li class="breadcrumb-item"><a href="./14_integracion_numerica.html">Integración Numérica</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Integrales Numéricas</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Incluso para funciones sencillas puede no ser posible obtener una respuesta analítica (“a mano”) para sus integrales. Por eso son importantes los métodos de integración. Empezaremos por los más sencillos.</p>
<div id="2c713a93" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="integrales-de-polinomios-interpolantes" class="level1">
<h1>Integrales de polinomios interpolantes</h1>
<p>Nuestro primer intento es usar los polinomios interpolantes de Lagrange para integrar.</p>
<p><span class="math display">\[
\int_a^b dx\,f(x) = \int_a^b dx\, \sum_{i=0}^n f(x_i) L_i(x) + \int_a^b dx\,\prod_{i=0}^n (x - x_i) \frac{f^{(n + 1)}(\xi)}{(n + 1)!}
\]</span></p>
<p>Interpolando toda la función con un polinomio lineal obtenemos la <em>regla del trapecio</em></p>
<p><span class="math display">\[
\int_{x_o}^{x_1} dx\,f(x) = \frac{(x_1-x_o)}{2}[f(x_o) + f(x_1)] - \frac{h^3}{12}f''(\xi)
\]</span></p>
<div id="949f4a7e" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">100</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, np.cos(x), alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, np.cos(<span class="dv">2</span>)<span class="op">*</span>x<span class="op">/</span><span class="dv">2</span> <span class="op">-</span> np.cos(<span class="dv">0</span>)<span class="op">*</span>(x <span class="op">-</span> <span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>plt.scatter([<span class="dv">0</span>,<span class="dv">2</span>], [np.cos(<span class="dv">0</span>), np.cos(<span class="dv">2</span>)])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="14_integracion_numerica_files/figure-html/cell-3-output-1.png" width="582" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cfa0d71c" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trapecio_uno(fxo, fx1, h):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (h<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(fxo <span class="op">+</span> fx1) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bacb5e73" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>trapecio_uno(np.cos(<span class="dv">0</span>), np.cos(<span class="dv">2</span>), <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>np.float64(0.5838531634528576)</code></pre>
</div>
</div>
<div id="44ab815d" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>np.sin(<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>np.float64(0.9092974268256817)</code></pre>
</div>
</div>
<p>Interpolando la función con un polinomio cuadrático obtenemos la <em>regla de Simpson</em></p>
<p><span class="math display">\[
\int_{x_o}^{x_2} dx\,f(x) = \frac{h}{3}(f(x_o) + 4f(x_1) + f(x_2)) - \frac{h^5}{90}f^{(4)}(\xi)
\]</span></p>
<p>(El término de error rigurosamente no se puede deducir a partir de los polinomios de Lagrange, ver libro)</p>
<div id="39bf3f54" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">100</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, np.cos(x), alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, np.cos(<span class="dv">0</span>)<span class="op">*</span>(x <span class="op">-</span> <span class="dv">2</span>)<span class="op">*</span>(x <span class="op">-</span> <span class="dv">1</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">1</span>) <span class="op">-</span> <span class="op">\</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                 np.cos(<span class="dv">1</span>)<span class="op">*</span>x<span class="op">*</span>(x<span class="op">-</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">1</span><span class="op">*</span><span class="dv">1</span>) <span class="op">+</span> np.cos(<span class="dv">2</span>)<span class="op">*</span>x<span class="op">*</span>(x<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">1</span>), alpha <span class="op">=</span> <span class="fl">0.2</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>plt.scatter([<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>], [np.cos(<span class="dv">0</span>), np.cos(<span class="dv">1</span>), np.cos(<span class="dv">2</span>)])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="14_integracion_numerica_files/figure-html/cell-7-output-1.png" width="582" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="3caf490d" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simpson_uno(fxo, fx1, fx2, h):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (h<span class="op">/</span><span class="dv">3</span>)<span class="op">*</span>(fxo <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>fx1 <span class="op">+</span> fx2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4d1e6aa6" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>simpson_uno(np.cos(<span class="dv">0</span>), np.cos(<span class="dv">1</span>), np.cos(<span class="dv">2</span>), <span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>np.float64(0.9150207956418055)</code></pre>
</div>
</div>
<p>Estos son casos especiales de la llamada fórmula de Newton-Cotes cerrada, que se apoya en el siguiente teorema (que no demostraremos):</p>
<p><strong>Teorema</strong>: Sea <span class="math inline">\(f \in C^{n+2}[a,b]\)</span>, entonces existe un <span class="math inline">\(\xi \in (a,b)\)</span> tal que</p>
<p><span class="math display">\[
\int_{a}^b dx\,f(x) = \sum_{i = 0}^n a_i f(x_i) + \frac{h^{n+3}f^{(n+2)}(\xi)}{(n + 2)!}\int_0^n dt\,t^2(t-1)...(t-n)
\]</span></p>
<p>donde <span class="math inline">\(n\)</span> es par, <span class="math inline">\(a_i = \int_a^b dx\, L_{n,i}(x)\)</span> y <span class="math inline">\(x_o = a\)</span>, <span class="math inline">\(x_n = b\)</span>. Análogamente si <span class="math inline">\(n\)</span> es impar y <span class="math inline">\(f \in C^{n+1}[a,b]\)</span>, entonces</p>
<p><span class="math display">\[
\int_{a}^b dx\,f(x) = \sum_{i = 0}^n a_i f(x_i) + \frac{h^{n+2}f^{(n+1)}(\xi)}{(n + 2)!}\int_0^n dt\,t^2(t-1)...(t-n)
\]</span></p>
<p>Pero no necesariamente tenemos que escoger <span class="math inline">\(x_o = a\)</span> y <span class="math inline">\(x_n = b\)</span>. Podemos tomar puntos que estén entre <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> pero sin usar los extremos para obtener los polinomios interpolantes. En este caso se usa la fórmula de Newton-Cotes abierta:</p>
<p><strong>Teorema</strong>: Sea <span class="math inline">\(f \in C^{n+2}[a,b]\)</span>, entonces existe un <span class="math inline">\(\xi \in (a,b)\)</span> tal que</p>
<p><span class="math display">\[
\int_{a}^b dx\,f(x) = \sum_{i = 0}^n a_i f(x_i) + \frac{h^{n+3}f^{(n+2)}(\xi)}{(n + 2)!}\int_{-1}^{n+1} dt\,t^2(t-1)...(t-n)
\]</span></p>
<p>donde <span class="math inline">\(n\)</span> es par, <span class="math inline">\(a_i = \int_a^b L_{n,i}(x)\)</span> y <span class="math inline">\(a = x_o - h\)</span>, <span class="math inline">\(b = x_n + h\)</span>. Análogamente si <span class="math inline">\(n\)</span> es impar y <span class="math inline">\(f \in C^{n+1}[a,b]\)</span>, entonces</p>
<p><span class="math display">\[
\int_{a}^b dx\,f(x) = \sum_{i = 0}^n a_i f(x_i) + \frac{h^{n+2}f^{(n+1)}(\xi)}{(n + 2)!}\int_{-1}^{n+1} dt\,t^2(t-1)...(t-n)
\]</span></p>
<p>Un caso especial es la llamada <em>regla del punto medio</em> con <span class="math inline">\(n = 0\)</span> (con <span class="math inline">\(h = (b - a)\)</span>):</p>
<p><span class="math display">\[
\int_a^b dx\,f(x) = hf((b-a)/2) + \frac{h^3}{24}f''(\xi)
\]</span></p>
<div id="e6f05e39" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">100</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, np.cos(x), alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, np.cos(<span class="dv">1</span>), alpha <span class="op">=</span> <span class="fl">0.2</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>plt.scatter([<span class="dv">1</span>], [np.cos(<span class="dv">1</span>)])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="14_integracion_numerica_files/figure-html/cell-10-output-1.png" width="582" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="b9ca04a3" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> punto_medio_uno(fxo, h):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>fxo</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1f8c689d" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>punto_medio_uno(np.cos(<span class="dv">1</span>), <span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>np.float64(1.0806046117362795)</code></pre>
</div>
</div>
</section>
<section id="integrales-compuestas" class="level1">
<h1>Integrales compuestas</h1>
<p>Para aproximar funciones más complicadas necesitaríamos polinomios de alto orden, pero ya sabemos que éstos pueden introducir oscilaciones indeseadas. Por eso podemos en cambio dividir el intervalo de integración en muchos intervalos pequeños de ancho <span class="math inline">\(h\)</span> y obtener mejores aproximaciones a las integrales (como hubiera hecho Arquímedes).</p>
<p><strong>Fórmula compuesta del punto medio:</strong></p>
<p><span class="math display">\[
\int_a^b dx\,f(x) = h\sum_{i = 0}^n f((x_{i +1} - x_i)/2) + \frac{h^3}{24}\sum_{i=0}^n f''(\xi_i)
\]</span></p>
<p>Pero hay un teorema (llamado del valor intermedio) que nos dice que si <span class="math inline">\(f''(x)\)</span> es continua, existe <span class="math inline">\(\mu \in [\xi_o,\xi_n]\)</span> tal que</p>
<p><span class="math display">\[
\frac{1}{n}\sum_{i=0}^n f''(\xi_i) = f''(\mu)
\]</span></p>
<p>y dado que <span class="math inline">\(nh = (b-a)\)</span> tenemos que</p>
<p><span class="math display">\[
\int_a^b dx\,f(x) = h\sum_{i = 0}^n f((x_{i +1} - x_i)/2) + \frac{h^2 (b - a)}{24} f''(\mu)
\]</span></p>
<div id="aa041e6f" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">100</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, np.cos(x), alpha <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>xi <span class="op">=</span> np.array([<span class="dv">0</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>xp <span class="op">=</span> np.array([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>,<span class="dv">3</span><span class="op">/</span><span class="dv">4</span>,<span class="dv">3</span><span class="op">/</span><span class="dv">4</span>,<span class="dv">5</span><span class="op">/</span><span class="dv">4</span>,<span class="dv">5</span><span class="op">/</span><span class="dv">4</span>,<span class="dv">7</span><span class="op">/</span><span class="dv">4</span>,<span class="dv">7</span><span class="op">/</span><span class="dv">4</span>])</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>plt.fill_between(xi, np.cos(xp), alpha <span class="op">=</span> <span class="fl">0.2</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>plt.scatter(xp, np.cos(xp))</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(xi)):</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    plt.plot([xi[i],xi[i]], [<span class="dv">0</span>,np.cos(xp[i])], color<span class="op">=</span><span class="st">'black'</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, linestyle <span class="op">=</span> <span class="st">':'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="14_integracion_numerica_files/figure-html/cell-13-output-1.png" width="582" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="a8559203" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> punto_medio(f, a, b, n):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> (b<span class="op">-</span>a)<span class="op">/</span>n</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    fx <span class="op">=</span> f(np.linspace(a <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, b <span class="op">-</span> h<span class="op">/</span><span class="dv">2</span>, n, endpoint<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> h<span class="op">*</span><span class="bu">sum</span>(fx)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="eda41ae0" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>punto_medio(np.cos, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>np.float64(0.9188387986651211)</code></pre>
</div>
</div>
<p><strong>Fórmula compuesta del trapecio:</strong></p>
<p><span class="math display">\[
\int_a^b dx\,f(x) = \frac{h}{2}\sum_{i=0}^{n-1}[f(x_{i+1}) + f(x_i)] - \frac{h^2 (b-a)}{12}f''(\mu)
\]</span></p>
<p>Pero podemos reorganizar la suma</p>
<p><span class="math display">\[
\int_a^b dx\,f(x) = \frac{h}{2}\left[\sum_{i=1}^{n} f(x_i) + \sum_{i=0}^{n-1} f(x_i)\right]- \frac{h^2 (b-a)}{12}f''(\mu)
\]</span></p>
<p>y esto es igual a</p>
<p><span class="math display">\[
\int_a^b dx\,f(x) = \frac{h}{2}\left[f(a) + 2\sum_{i=1}^{n-1} f(x_i) + f(b)\right]- \frac{h^2 (b-a)}{12}f''(\mu)
\]</span></p>
<div id="c41bf417" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">100</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, np.cos(x), alpha <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="dv">2</span><span class="op">/</span><span class="dv">4</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> poly(x):</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    ind <span class="op">=</span> <span class="bu">int</span>(x<span class="op">/</span>h)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span>np.cos(h<span class="op">*</span>ind)<span class="op">*</span>(x <span class="op">-</span> h<span class="op">*</span>(ind<span class="op">+</span><span class="dv">1</span>))<span class="op">/</span>h <span class="op">+</span> np.cos(h<span class="op">*</span>(ind<span class="op">+</span><span class="dv">1</span>))<span class="op">*</span>(x <span class="op">-</span> h<span class="op">*</span>ind)<span class="op">/</span>h</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, [poly(xi) <span class="cf">for</span> xi <span class="kw">in</span> x], alpha <span class="op">=</span> <span class="fl">0.2</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>xp <span class="op">=</span> np.arange(<span class="dv">5</span>)<span class="op">*</span>h</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>plt.scatter(xp, np.cos(xp))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="14_integracion_numerica_files/figure-html/cell-16-output-1.png" width="582" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="3d97844b" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trapecio(f, a, b, n):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> (b <span class="op">-</span> a)<span class="op">/</span>n</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    fx <span class="op">=</span> f(np.linspace(a<span class="op">+</span>h, b<span class="op">-</span>h, n<span class="op">-</span><span class="dv">1</span>, endpoint<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (h<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(f(a) <span class="op">+</span> <span class="dv">2</span><span class="op">*</span><span class="bu">sum</span>(fx) <span class="op">+</span> f(b))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a719b929" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>trapecio(np.cos, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>np.float64(0.890274325576322)</code></pre>
</div>
</div>
<p><strong>Fórmula compuesta de Simpson</strong>: Se deduce de manera análoga</p>
<p><span class="math display">\[
\int_a^b dx\,f(x) = \frac{h}{3}\left[f(a) + 2\sum_{i=1}^{n/2-1} f(x_{2i}) + 4\sum_{i=1}^{n/2} f(x_{2i-1}) + f(b)\right]- \frac{h^4 (b-a)}{180}f''(\mu)
\]</span></p>
<div id="49623997" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">100</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, np.cos(x), alpha <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="dv">2</span><span class="op">/</span><span class="dv">4</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> poly(x):</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    ind <span class="op">=</span> <span class="bu">int</span>(x<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>h))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    Lo <span class="op">=</span> (x <span class="op">-</span> h<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>ind<span class="op">+</span><span class="dv">1</span>))<span class="op">*</span>(x <span class="op">-</span> h<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>ind<span class="op">+</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>h)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    L1 <span class="op">=</span> <span class="op">-</span>(x <span class="op">-</span> h<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>ind))<span class="op">*</span>(x <span class="op">-</span> h<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>ind<span class="op">+</span><span class="dv">2</span>))<span class="op">/</span>(h<span class="op">*</span>h)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    L2 <span class="op">=</span> (x <span class="op">-</span> h<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>ind))<span class="op">*</span>(x <span class="op">-</span> h<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>ind<span class="op">+</span><span class="dv">1</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>h)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.cos(<span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>ind)<span class="op">*</span>Lo <span class="op">+</span> np.cos(h<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>ind<span class="op">+</span><span class="dv">1</span>))<span class="op">*</span>L1 <span class="op">+</span> np.cos(h<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>ind<span class="op">+</span><span class="dv">2</span>))<span class="op">*</span>L2</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, [poly(xi) <span class="cf">for</span> xi <span class="kw">in</span> x], alpha <span class="op">=</span> <span class="fl">0.2</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>xp <span class="op">=</span> np.arange(<span class="dv">5</span>)<span class="op">*</span>h</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>plt.scatter(xp, np.cos(xp))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="14_integracion_numerica_files/figure-html/cell-19-output-1.png" width="582" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A pesar de que la potencia de <span class="math inline">\(h\)</span> de los métodos compuestos es menor (mayor error), en realidad no son comparables ya que <span class="math inline">\(h\)</span> es mucho menor en los métodos compuestos.</p>
<section id="estabilidad-de-los-métodos-por-polinomios-interpolantes" class="level2">
<h2 class="anchored" data-anchor-id="estabilidad-de-los-métodos-por-polinomios-interpolantes">Estabilidad de los métodos por polinomios interpolantes</h2>
<p>El error de redondeo o intrínseco de estos métodos <em>no cambia al cambiar <span class="math inline">\(h\)</span></em>. Esto quiere decir que el método es estable, pero cuando el error del método es lo comparable con el error intrínseco no se gana nada con reducir <span class="math inline">\(h\)</span> ulteriormente.</p>
<p>Deduscamos este hecho para la regla de Simpson. Si <span class="math inline">\(f(x_i) = \tilde{f}(x_i) + e_i\)</span> y si además <span class="math inline">\(e_i \leq \epsilon\)</span> tenemos</p>
<p><span class="math display">\[
e(h) = \left|\frac{h}{3}\left[e_o + 2\sum_{i=1}^{n/2-1} e_{2i} + 4\sum_{i=1}^{n/2} e_{2i-1} + e_n\right]\right| \leq \frac{h}{3}\left|\epsilon + 2\left(\frac{n}{2} - 1\right)\epsilon + 4\frac{n}{2}\epsilon + \epsilon\right| = \frac{h}{3}3n\epsilon = (b - a)\epsilon
\]</span></p>
</section>
</section>
<section id="métodos-de-paso-variable" class="level1">
<h1>Métodos de paso variable</h1>
<p>Los métodos vistos anteriormente funcionan bastante bien en muchos casos. Sin embargo esos métodos no son óptimos cuando una función varía mucho. Por ejemplo:</p>
<div id="a0c81b5a" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">7</span>,<span class="dv">100</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>plt.plot(x, np.exp(<span class="op">-</span>x)<span class="op">*</span>np.sin(x))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x, np.zeros(<span class="dv">100</span>), color <span class="op">=</span> <span class="st">'black'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="14_integracion_numerica_files/figure-html/cell-20-output-1.png" width="579" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Vemos que el intervalo entre <span class="math inline">\(x = 6\)</span> y <span class="math inline">\(x = 7\)</span> contribuye poco a la integral y además una aproximación burda puede ser buena allí. Se necesitan pocos puntos para lograr una buena aproxmación, que será cercana a cero. Sin embargo el intervalo entre <span class="math inline">\(x = 0\)</span> y <span class="math inline">\(x = 3\)</span> contribuye mucho a la integral de esta función y además la función varía rápidamente allí. Por lo tanto necesitaremos más puntos.</p>
<section id="método-de-cuadratura-adaptativa" class="level2">
<h2 class="anchored" data-anchor-id="método-de-cuadratura-adaptativa">Método de cuadratura adaptativa</h2>
<p>El método de paso adaptativo consiste en aproximar la integral como un polinomio interpolante en varios intervalos. El tamaño de cada intervalo es tal que el error cometido allí sea menor que una tolerancia <span class="math inline">\(\epsilon/f\)</span>, donde <span class="math inline">\(f\)</span> es la fracción del rango de integración ocupada por el intervalo <span class="math inline">\(f = (b-a)/h\)</span>. De esta forma, la suma de la aproximación en todos los subintervalos tiene un error menor que <span class="math inline">\(\epsilon\)</span>.</p>
<p>Tenemos entonces dos tareas:</p>
<ul>
<li>Estimar el error cometido en una aproximación dada.</li>
<li>Dividir el rango de integración para lograr el error requerido.</li>
</ul>
<p>Para estimar el error habría que usar la fórmula de error de las aproximaciones de la clase pasada. El problema es que éstas involucran derivadas de alto orden. Recordemos la regla de simpson</p>
<p><span class="math display">\[
\int_{a}^{b} dx\,f(x) = \frac{h}{3}(f(a) + 4f(a + h) + f(b)) - \frac{h^5}{90}f^{(4)}(\xi) \equiv S_o  - \frac{h^5}{90}f^{(4)}(\xi)
\]</span></p>
<p>En general es difícil calcular la cuarta derivada, y estimarla numéricamente puede costar muchas evaluaciones de la función (además de ser inestable). Lo que podemos hacer es dividir el rango de integración a la mitad, y luego usar la regla de Simpson en cada mitad para obtener:</p>
<p><span class="math display">\[
\int_a^b dx\,f(x) = \frac{h}{6}(f(a) + 4f(a + h/2) + 2f(a + h) + 4f(a + 3h/2) + f(b)) - \frac{1}{16}\frac{h^5}{90}f^{(4)}(\bar{\xi}) \equiv S_1  - \frac{1}{16}\frac{h^5}{90}f^{(4)}(\xi)
\]</span></p>
<p>Si asumimos que <span class="math inline">\(f^{(4)}(\bar{\xi}) \approx f^{(4)}(\xi)\)</span>, tenemos</p>
<p><span class="math display">\[
\frac{15}{16}\frac{h^5}{90}f^{(4)}(\xi) = S_o - S_1
\]</span></p>
<p>y entonces el error cometido al usar la aproximación S_1 es</p>
<p><span class="math display">\[
S_1 - \int_a^b dx\,f(x) = \frac{1}{15}(S_o - S_1)
\]</span></p>
<p>Para determinar los intervalos de integración la estrategia es:</p>
<ol type="1">
<li>Calcular la integral y el error en un intervalo.</li>
<li>Si el error es mayor que la tolerancia, dividir el intervalo a la mitad.</li>
<li>Repetir los pasos 1 y 2 para cada subintervalo.</li>
</ol>
<div id="c8844d72" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MaxIterations(<span class="pp">Exception</span>):</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> adaptive(f, a, b, tol, N<span class="op">=</span><span class="dv">100_000</span>):</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables iniciales</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    approx <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    toli <span class="op">=</span> [<span class="dv">10</span><span class="op">*</span>tol]</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    ai <span class="op">=</span> [a]</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    hi <span class="op">=</span> [(b <span class="op">-</span> a)<span class="op">/</span><span class="dv">2</span>]</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    fai <span class="op">=</span> [f(a)]</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    fbi <span class="op">=</span> [f(b)]</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    fci <span class="op">=</span> [f(a <span class="op">+</span> hi[i])]</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    S0i <span class="op">=</span> [hi[i]<span class="op">*</span>(fai[i] <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>fci[i] <span class="op">+</span> fbi[i])<span class="op">/</span><span class="dv">3</span>]</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    Li <span class="op">=</span> [<span class="dv">1</span>]</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;=</span> <span class="dv">0</span>:</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>        fd <span class="op">=</span> f(ai[i] <span class="op">+</span> hi[i]<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>        fe <span class="op">=</span> f(ai[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>hi[i]<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>        S1 <span class="op">=</span> hi[i]<span class="op">*</span>(fai[i] <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>fd <span class="op">+</span> fci[i])<span class="op">/</span><span class="dv">6</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>        S2 <span class="op">=</span> hi[i]<span class="op">*</span>(fci[i] <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>fe <span class="op">+</span> fbi[i])<span class="op">/</span><span class="dv">6</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>        ai_prec <span class="op">=</span> ai[i]</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>        hi_prec <span class="op">=</span> hi[i]</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>        fai_prec <span class="op">=</span> fai[i]</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>        fbi_prec <span class="op">=</span> fbi[i]</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>        fci_prec <span class="op">=</span> fci[i]</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>        toli_prec <span class="op">=</span> toli[i]</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>        S0i_prec <span class="op">=</span> S0i[i]</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>        Li_prec <span class="op">=</span> Li[i]</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>        i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">abs</span>(S1 <span class="op">+</span> S2 <span class="op">-</span> S0i_prec) <span class="op">&lt;</span> toli_prec:</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>            approx <span class="op">+=</span> S1 <span class="op">+</span> S2</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> Li_prec <span class="op">&gt;=</span> N:</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>                <span class="cf">raise</span> MaxIterations(<span class="st">"Alcanzado máximo número de iteraciones."</span>)</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Intervalo derecho</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>            i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">&gt;=</span> <span class="bu">len</span>(ai): <span class="co"># A veces hay que ampliar la lista</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>                ai.append(ai_prec <span class="op">+</span> hi_prec)</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>                fai.append(fci_prec)</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>                fci.append(fe)</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>                fbi.append(fbi_prec)</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>                hi.append(hi_prec<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>                toli.append(toli_prec<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>                S0i.append(S2)</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>                Li.append(Li_prec <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>                ai[i] <span class="op">=</span> ai_prec <span class="op">+</span> hi_prec</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>                fai[i] <span class="op">=</span> fci_prec</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>                fci[i] <span class="op">=</span> fe</span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>                fbi[i] <span class="op">=</span> fbi_prec</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>                hi[i] <span class="op">=</span> hi_prec<span class="op">/</span><span class="dv">2</span></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>                toli[i] <span class="op">=</span> toli_prec<span class="op">/</span><span class="dv">2</span></span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>                S0i[i] <span class="op">=</span> S2</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>                Li[i] <span class="op">=</span> Li_prec <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Intervalo izquierdo</span></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>            i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">&gt;=</span> <span class="bu">len</span>(ai):</span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>                ai.append(ai_prec)</span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>                fai.append(fai_prec)</span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>                fci.append(fd)</span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>                fbi.append(fci_prec)</span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>                hi.append(hi[i<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>                toli.append(toli[i<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>                S0i.append(S1)</span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a>                Li.append(Li[i<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>                ai[i] <span class="op">=</span> ai_prec</span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>                fai[i] <span class="op">=</span> fai_prec</span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a>                fci[i] <span class="op">=</span> fd</span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a>                fbi[i] <span class="op">=</span> fci_prec</span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a>                hi[i] <span class="op">=</span> hi[i<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a>                toli[i] <span class="op">=</span> toli[i<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a>                S0i[i] <span class="op">=</span> S1</span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a>                Li[i] <span class="op">=</span> Li[i<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> approx</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="90bb7d95" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>adaptive(np.cos, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.00000001</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>np.float64(0.8414709892666887)</code></pre>
</div>
</div>
</section>
</section>
<section id="tareas" class="level1">
<h1>¡Tareas!</h1>
<section id="tarea-7.1" class="level2">
<h2 class="anchored" data-anchor-id="tarea-7.1">Tarea 7.1</h2>
<p>Ejercicio 4.4.22 del libro de Burden de análisis numérico.</p>
<p>La ecuación</p>
<p><span class="math display">\[
\int_0^x dt\,\frac{1}{\sqrt{2\pi}}e^{-t^2/2} = 0.45\,,
\]</span></p>
<p>se puede resolver para <span class="math inline">\(x\)</span> usando el método de Newton. Para lograrlo es necesario evaluar la función</p>
<p><span class="math display">\[
f(p) = \int_0^p dt\,\frac{1}{\sqrt{2\pi}}e^{-t^2/2} - 0.45\,.
\]</span></p>
<p>Use el método compuesto del trapecio para evaluar esta función y luego use el método de Newton para encontrar <span class="math inline">\(x\)</span> con una precisión de <span class="math inline">\(10^{-5}\)</span>.</p>
</section>
<section id="tarea-7.2" class="level2">
<h2 class="anchored" data-anchor-id="tarea-7.2">Tarea 7.2</h2>
<p>Use el método compuesto de Simpson y el método compuesto del trapecio para encontrar la siguiente integral</p>
<p><span class="math display">\[
\int_0^4 \frac{dx}{\sqrt{x^2 + 16}}
\]</span></p>
<p>Compare con el resultado exacto para obtener el error cometido. Grafique el error en función de <span class="math inline">\(h\)</span> para ambos métodos y compare con las fórmulas de error.</p>
</section>
<section id="tarea-7.3" class="level2">
<h2 class="anchored" data-anchor-id="tarea-7.3">Tarea 7.3</h2>
<p>Suponga que la medición de un cierto proceso físico da como resultado la siguiente expresión</p>
<p><span class="math display">\[
p(x) = \sin x + n(x)
\]</span></p>
<p>donde <span class="math inline">\(n\)</span> es el error experimental que podemos describir como un número aleatorio, para cada valor de <span class="math inline">\(x\)</span>, tomado de una distribución gaussiana con media <span class="math inline">\(0\)</span> y desviación estándar <span class="math inline">\(10^{-5}\)</span>. Queremos calcular la integral</p>
<p><span class="math display">\[
\int_0^1 dx\,p(x)\,.
\]</span></p>
<p>Use el método compuesto de Simpson para calcular esta integral. El verdadero valor de esta integral es <span class="math inline">\(1-\cos(1)\)</span>. Grafique el error cometido en función de <span class="math inline">\(h\)</span>. ¿Se puede lograr una precisión de <span class="math inline">\(10^{-7}\)</span>? ¿Por qué?</p>
</section>
<section id="tarea-7.4" class="level2">
<h2 class="anchored" data-anchor-id="tarea-7.4">Tarea 7.4</h2>
<p>Calcule la integral de la función Gaussiana <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}}e^{-x^2/2}\)</span> en el intervalo <span class="math inline">\((0, 3)\)</span>. Use el método de cuadratura adaptativa implementado en clase para varias tolerancias. Compare con el valor exacto y grafique el error cometido en función de la tolerancia. ¿Es lo que esperaba?</p>
<p>Para obtener el valor exacto, busque información sobre la llamada “función de error”.</p>
</section>
<section id="tarea-7.5" class="level2">
<h2 class="anchored" data-anchor-id="tarea-7.5">Tarea 7.5</h2>
<p>Calcule la integral del seno entre <span class="math inline">\(0\)</span> y <span class="math inline">\(1\)</span>. Para ello use el método compuesto de Simpson y la cuadratura adaptativa implementada en clase. Hágalo para varias precisiones y grafique el tiempo que tardan ambos métodos en función de la precisión. (Para la precisión del método de Simpson es necesario usar la fórmula de error para calcular el número <span class="math inline">\(n\)</span> de intervalos).</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/jorgenorena\.github\.io\/metodos-numericos-sitio\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>