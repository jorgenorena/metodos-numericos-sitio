<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Integración de Monte Carlo – Métodos Numéricos y Probabilidades 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e13f217ceb0135cb77e1494052e28e8a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Métodos Numéricos y Probabilidades 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Buscar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Inicio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">Acerca de</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-unidad-1" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Unidad 1</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-unidad-1">    
        <li>
    <a class="dropdown-item" href="./01_funcionamiento_cpu.html">
 <span class="dropdown-text">Funcionamiento de la CPU</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02_python.html">
 <span class="dropdown-text">Repaso de Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./03_numpy_arrays.html">
 <span class="dropdown-text">Repaso de numpy, matplotlib, archivos</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./04_numeros_y_condicionamiento.html">
 <span class="dropdown-text">Representación de números y condicionamiento</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./05_algoritmos_y_estabilidad.html">
 <span class="dropdown-text">Algoritmos y estabilidad</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-unidad-2" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Unidad 2</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-unidad-2">    
        <li>
    <a class="dropdown-item" href="./06_definicion_probabilidad.html">
 <span class="dropdown-text">Propiedades de la probabilidad</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./07_distribuciones.html">
 <span class="dropdown-text">Distribuciones de probabilidad</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./08_varias_variables_aleatorias.html">
 <span class="dropdown-text">Varias variables aleatorias</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./09_teorema_central_del_limite.html">
 <span class="dropdown-text">Teorema central del límite</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./10_entropia.html">
 <span class="dropdown-text">Entropía de Shannon</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-unidad-3" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Unidad 3</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-unidad-3">    
        <li>
    <a class="dropdown-item" href="./11_solucion_sistemas_lineales.html">
 <span class="dropdown-text">Solución de Sistemas de Ecuaciones Lineales</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./12_newton_y_biseccion.html">
 <span class="dropdown-text">Solución de Ecuaciones No Lineales</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./13_interpolacion.html">
 <span class="dropdown-text">Interpolación</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./14_integracion_numerica.html">
 <span class="dropdown-text">Integración Numérica</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./15_integrales_multiples_impropias_y_gauss.html">
 <span class="dropdown-text">Quadratura de Gauss, integrales múltiples e impropias</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./16_derivadas.html">
 <span class="dropdown-text">Derivadas numéricas</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-unidad-4" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Unidad 4</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-unidad-4">    
        <li>
    <a class="dropdown-item" href="./17_metodos_de_taylor.html">
 <span class="dropdown-text">Métodos de Taylor</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./18_runge_kutta.html">
 <span class="dropdown-text">Métodos de Runge-Kutta</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./19_metodos_de_multiples_pasos.html">
 <span class="dropdown-text">Métodos de Múltiples Pasos</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./20_edo_alto_orden_estabilidad.html">
 <span class="dropdown-text">Ecuaciones de alto orden y estabilidad</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-unidad-5" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Unidad 5</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-unidad-5">    
        <li>
    <a class="dropdown-item" href="./21_ajuste_de_curvas.html">
 <span class="dropdown-text">Ajustes de mínimos cuadrados</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./22_descenso_de_gradiente.html">
 <span class="dropdown-text">Descenso de gradiente</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./23_redes_neuronales.html">
 <span class="dropdown-text">Redes neuronales</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./24_integracion_monte_carlo.html">
 <span class="dropdown-text">Integración de Monte Carlo</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./25_transformada_de_fourier.html">
 <span class="dropdown-text">Transformada de Fourier</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./21_ajuste_de_curvas.html">Unidad 5: Tópicos</a></li><li class="breadcrumb-item"><a href="./24_integracion_monte_carlo.html">Integración de Monte Carlo</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Unidad 1: Introducción</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_funcionamiento_cpu.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Funcionamiento de la CPU</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Repaso de Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_numpy_arrays.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Repaso de numpy, matplotlib, archivos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_numeros_y_condicionamiento.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Representación de números y condicionamiento</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_algoritmos_y_estabilidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Algoritmos y estabilidad</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Unidad 2: Probabilidad</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_definicion_probabilidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Propiedades de la probabilidad</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_distribuciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Distribuciones de probabilidad</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_varias_variables_aleatorias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Varias variables aleatorias</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_teorema_central_del_limite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Teorema central del límite</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_entropia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Entropía de Shannon</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Unidad 3: Cálculo Numérico</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_solucion_sistemas_lineales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solución de Sistemas de Ecuaciones Lineales</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_newton_y_biseccion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solución de Ecuaciones No Lineales</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_interpolacion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interpolación</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_integracion_numerica.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Integración Numérica</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_integrales_multiples_impropias_y_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quadratura de Gauss, integrales múltiples e impropias</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_derivadas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Derivadas numéricas</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Unidad 4: Ecuaciones Diferenciales</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_metodos_de_taylor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Métodos de Taylor</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18_runge_kutta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Métodos de Runge-Kutta</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19_metodos_de_multiples_pasos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Métodos de Múltiples Pasos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20_edo_alto_orden_estabilidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ecuaciones de alto orden y estabilidad</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Unidad 5: Tópicos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21_ajuste_de_curvas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ajustes de mínimos cuadrados</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22_descenso_de_gradiente.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Descenso de gradiente</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23_redes_neuronales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Redes neuronales</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24_integracion_monte_carlo.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Integración de Monte Carlo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25_transformada_de_fourier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transformada de Fourier</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#integración-de-monte-carlo-básica" id="toc-integración-de-monte-carlo-básica" class="nav-link active" data-scroll-target="#integración-de-monte-carlo-básica">Integración de Monte Carlo Básica</a></li>
  <li><a href="#muestreo-por-importancia" id="toc-muestreo-por-importancia" class="nav-link" data-scroll-target="#muestreo-por-importancia">Muestreo por Importancia</a></li>
  <li><a href="#mcmc-el-algoritmo-de-metropolishastings" id="toc-mcmc-el-algoritmo-de-metropolishastings" class="nav-link" data-scroll-target="#mcmc-el-algoritmo-de-metropolishastings">MCMC: El algoritmo de Metropolis–Hastings</a>
  <ul class="collapse">
  <li><a href="#balance-detallado" id="toc-balance-detallado" class="nav-link" data-scroll-target="#balance-detallado">Balance detallado</a></li>
  <li><a href="#construcción-mh" id="toc-construcción-mh" class="nav-link" data-scroll-target="#construcción-mh">Construcción MH</a>
  <ul class="collapse">
  <li><a href="#propuesta-gaussiana" id="toc-propuesta-gaussiana" class="nav-link" data-scroll-target="#propuesta-gaussiana">Propuesta gaussiana</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./21_ajuste_de_curvas.html">Unidad 5: Tópicos</a></li><li class="breadcrumb-item"><a href="./24_integracion_monte_carlo.html">Integración de Monte Carlo</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Integración de Monte Carlo</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Cuando queremos evaluar numéricamente una integral en muchas dimensiones, los métodos más eficientes son de monte carlo. Es decir, aproximan la integral mediante el uso de muestras aleatorias. Veamos cómo funciona.</p>
<p>Este tipo de integrales aparecen con frecuencia al realizar inferencia bayesiana. Esos casos consisten en la integración de funciones de distribución de probabilidad y nos enfocaremos en esto aquí.</p>
<section id="integración-de-monte-carlo-básica" class="level1">
<h1>Integración de Monte Carlo Básica</h1>
<p>Por simplicidad, consideremos integrales unidimensionales. Queremos calcular <span class="math display">\[
I = \int_a^b dx \, h(x).
\]</span> Esto lo reescribimos como <span class="math display">\[
I = \int_a^b dx \, g(x) \, w(x),
\]</span> donde <span class="math display">\[
w(x) = h(x)(b - a), \qquad g(x) = \frac{1}{b - a}.
\]</span></p>
<p>De esta forma, <span class="math display">\[
I = \langle w(X) \rangle,
\]</span> donde <span class="math inline">\(X\)</span> es una variable aleatoria tomada de una distribución uniforme en <span class="math inline">\([a, b]\)</span>.</p>
<p>Podemos entonces generar muchos <span class="math inline">\(X_i\)</span> y estimar <span class="math display">\[
\hat{I} = \frac{1}{N} \sum_{i=1}^N w(X_i),
\qquad \Rightarrow \qquad \langle w(X) \rangle \approx I.
\]</span></p>
<p>Esto es <strong>integración Monte Carlo</strong>.</p>
<p>También podemos estimar el error: <span class="math display">\[
se = \frac{s}{\sqrt{N}}, \qquad
s^2 = \frac{1}{N - 1} \sum_{i=1}^N (Y_i - \hat{I})^2, \qquad
Y_i \equiv w(X_i).
\]</span></p>
<p>En realidad, podemos generalizar y tomar <span class="math inline">\(g\)</span> como una distribución más general o más conveniente. Por ejemplo, podemos calcular integrales de la forma <span class="math inline">\(\int_a^b dx \, g(x) \, h(x)\)</span> tomando muestras de la distribución <span class="math inline">\(g\)</span>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
</div>
<div class="callout-body-container callout-body">
<p>Estimemos <span class="math inline">\(I = P(Z &gt; 3)\)</span> con <span class="math inline">\(Z\)</span> tomada de una distribución normal con media 0 y varianza 1. Sabemos que esto vale <span class="math inline">\(0.0013\)</span>.</p>
<div id="e7ba98dc" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> sqrt, pi, exp, erfc</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> np.random.default_rng(<span class="dv">42</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Densidades normal estándar y N(mu,1) en log-escala</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> log_phi(x):            <span class="co"># N(0,1)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>np.log(<span class="dv">2</span><span class="op">*</span>pi) <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span>x<span class="op">*</span>x</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> log_phi_mu(x, mu):     <span class="co"># N(mu,1)</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>np.log(<span class="dv">2</span><span class="op">*</span>pi) <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span>(x<span class="op">-</span>mu)<span class="op">*</span>(x<span class="op">-</span>mu)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor verdadero P(Z&gt;3)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>true_p <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>erfc(<span class="fl">3.0</span><span class="op">/</span>sqrt(<span class="fl">2.0</span>))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>true_p</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>0.0013498980316300957</code></pre>
</div>
</div>
<p>Pero usemos Monte Carlo.</p>
<div id="f8c8ac0f" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mc_plain(N, rng):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> rng.standard_normal(N)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> z <span class="op">&gt;</span> <span class="fl">3.0</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">10000</span>      <span class="co"># muestras </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>muestras <span class="op">=</span> mc_plain(N, rng)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>mc <span class="op">=</span> muestras.mean()</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>mc_var <span class="op">=</span> np.<span class="bu">sum</span>((muestras <span class="op">-</span> mc)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> (N <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>mc_se <span class="op">=</span> sqrt(mc_var)<span class="op">/</span>sqrt(N)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'N=</span><span class="sc">{</span>N<span class="sc">}</span><span class="ss">:</span><span class="ch">\n</span><span class="ss">Estima Monte Carlo=</span><span class="sc">{</span>mc<span class="sc">:.4f}</span><span class="ss">, Error estimado=</span><span class="sc">{</span>mc_se<span class="sc">:.4f}</span><span class="ss">, Valor verdadero=</span><span class="sc">{</span>true_p<span class="sc">:.4f}</span><span class="ss">'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>N=10000:
Estima Monte Carlo=0.0017, Error estimado=0.0004, Valor verdadero=0.0013</code></pre>
</div>
</div>
<p>Con <span class="math inline">\(N = 10000\)</span> encontramos <span class="math display">\[
\langle \hat{I} \rangle = 0.0017, \qquad V(\hat{I}) = 0.0004,
\]</span></p>
</div>
</div>
</section>
<section id="muestreo-por-importancia" class="level1">
<h1>Muestreo por Importancia</h1>
<p>Consideremos ahora <span class="math display">\[
I = \int dx \, h(x) f(x),
\]</span> donde <span class="math inline">\(f\)</span> es una pdf fija — por ejemplo, un posterior bayesiano. En muchos casos puede ocurrir no podemos tomar muestras de <span class="math inline">\(f\)</span> fácilmente. Pero podemos introducir una distribución auxiliar <span class="math inline">\(g\)</span> y tomar muestras de ella.</p>
<p>Podemos aplicar el mismo truco y escribir <span class="math display">\[
I = \int dx \, \frac{h(x) f(x)}{g(x)} g(x)
   = \langle Y(X) \rangle, \qquad
Y(X) = \frac{h(X) f(X)}{g(X)},
\]</span> donde <span class="math inline">\(X\)</span> es una variable aleatoria tomada de <span class="math inline">\(g\)</span>. De esta manera estimamos <span class="math display">\[
\hat{I} = \frac{1}{N} \sum_{i=1}^N Y_i.
\]</span></p>
<p>¿Qué condiciones debe satisfacer <span class="math inline">\(g\)</span>? Consideremos el segundo momento de <span class="math inline">\(w(X)\)</span>: <span class="math display">\[
\langle w(X)^2 \rangle = \int dx \, \frac{h^2(x) f^2(x)}{g(x)}.
\]</span></p>
<p>Si <span class="math inline">\(g \ll f\)</span> en las colas, esto no convergerá. Asimismo, si <span class="math inline">\(g \ll f\)</span> en alguna región, puede generar alta varianza. Por eso, tratamos de elegir <span class="math inline">\(g\)</span> similar a <span class="math inline">\(f\)</span>, pero <strong>más grande en las colas</strong>.</p>
<p>Podemos usar esto para escoger una <span class="math inline">\(g\)</span> que <strong>de más peso a los puntos que más contribuyen</strong>. Esto se llama <strong>muestreo por importancia</strong>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
</div>
<div class="callout-body-container callout-body">
<p>Estimemos la misma integral anterior usando muestreo por importancia. El Monte Carlo simple desperdicia muchos puntos que no están cerca de la cola derecha; la mayoría de puntos están en la región <span class="math inline">\(x &lt; 3\)</span>. Por eso, vamos a escoger <span class="math inline">\(g\)</span> que tenga mayor peso en la región <span class="math inline">\(x &lt; 3\)</span> para no desperdiciar tantos puntos.</p>
<p>Usemos <span class="math inline">\(g\)</span> como una distribución normal con media 4 y varianza 1.</p>
<div id="a13b5364" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mc_importance(N, rng):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> rng.normal(<span class="fl">4.0</span>, <span class="fl">1.0</span>, N)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.exp(log_phi(z) <span class="op">-</span> log_phi_mu(z, <span class="fl">4.0</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y<span class="op">*</span>(z <span class="op">&gt;</span> <span class="fl">3.0</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">10000</span>      <span class="co"># muestras </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>muestras <span class="op">=</span> mc_importance(N, rng)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>mc <span class="op">=</span> muestras.mean()</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>mc_var <span class="op">=</span> np.<span class="bu">sum</span>((muestras <span class="op">-</span> mc)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> (N <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>mc_se <span class="op">=</span> sqrt(mc_var)<span class="op">/</span>sqrt(N)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'N=</span><span class="sc">{</span>N<span class="sc">}</span><span class="ss">:</span><span class="ch">\n</span><span class="ss">Estima Monte Carlo=</span><span class="sc">{</span>mc<span class="sc">:.5f}</span><span class="ss">, Error estimado=</span><span class="sc">{</span>mc_se<span class="sc">:.5f}</span><span class="ss">, Valor verdadero=</span><span class="sc">{</span>true_p<span class="sc">:.5f}</span><span class="ss">'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>N=10000:
Estima Monte Carlo=0.00137, Error estimado=0.00003, Valor verdadero=0.00135</code></pre>
</div>
</div>
<p>Usandi el muestreo por importancia logramos una <strong>mejora por un factor r10</strong> en el error.</p>
</div>
</div>
</section>
<section id="mcmc-el-algoritmo-de-metropolishastings" class="level1">
<h1>MCMC: El algoritmo de Metropolis–Hastings</h1>
<p>La idea es generar muestras de una distribución <span class="math inline">\(f(x)\)</span> compleja usando una cadena de Markov. La cadena de Markov es una secuencia de variables aleatorias <span class="math inline">\(\{X_1, X_2, \ldots\}\)</span> donde la distribución de <span class="math inline">\(X_{i+1}\)</span> depende solo de <span class="math inline">\(X_i\)</span>. Es decir, <span class="math inline">\(X_{i+1}\)</span> se extrae de una distribución de probabilidad que depende sólo del elemento anterior en la cadena <span class="math inline">\(p(X_i \mid X_{i-1})\)</span>.</p>
<p>Queremos hacer que la distribución de los <span class="math inline">\(X_i\)</span> converja a <span class="math inline">\(f(x)\)</span>. ¿Pero qué quiere decir esta convergencia? Intuitivamente, significa que a medida que generamos más y más muestras de la cadena de Markov, la distribución de estas muestras se asemeja cada vez más a la distribución objetivo <span class="math inline">\(f(x)\)</span>. En el límite, cuando el número de muestras tiende a infinito, la distribución de los <span class="math inline">\(X_i\)</span> debe coincidir con <span class="math inline">\(f(x)\)</span>.</p>
<p>Pero tenemos un problema: En general, si partimos por un punto inicial <span class="math inline">\(X_o\)</span> obtenido de la distribución <span class="math inline">\(f(x)\)</span>, el siguiente punto no necesariamente tiene la misma distribución. De hecho, la distribución de probabilidad de obtener un valor <span class="math inline">\(x_1\)</span> será <span class="math inline">\(\int dx_o\,p(x_1|x_o)f(x_o)\)</span>. Necesitamos que esta distribución sea igual a la <span class="math inline">\(f(x)\)</span>, es decir pedimos</p>
<p><span class="math display">\[
\int dx\, p(y|x)f(x) = f(y)\,,
\]</span></p>
<p>cuando <span class="math inline">\(f(x)\)</span> y <span class="math inline">\(p(y\mid x)\)</span> satisfacen esta condición, decimos que la distribución <span class="math inline">\(f(x)\)</span> es una <strong>distribución estacionaria</strong> de la cadena definida por <span class="math inline">\(p(y\mid x)\)</span>.</p>
<p>La idea para integrar <span class="math inline">\(f(x)\)</span> entonces es generar una cadena de Markov cuya distribución estacionaria sea <span class="math inline">\(f\)</span>. Entonces, por la ley de los grandes números, <span class="math display">\[
\frac{1}{N}\sum_{i=1}^N h(X_i) \;\xrightarrow{\;P\;}\; \langle h(X)\rangle .
\]</span></p>
<section id="balance-detallado" class="level2">
<h2 class="anchored" data-anchor-id="balance-detallado">Balance detallado</h2>
<p>Una manera de lograr este requisito que parece tan difícil, es encontrar una cadena que satisfaga <strong>balance detallado</strong> <span class="math display">\[
f(x)\, p(y\mid x) \;=\; f(y)\, p(x\mid y),
\]</span></p>
<p>donde <span class="math inline">\(p(y\mid x)\)</span> es la probabilidad de ir de <span class="math inline">\(x\)</span> a <span class="math inline">\(y\)</span>. Con esto, <span class="math display">\[
\int dy\, f(y)\, p(x\mid y) \;=\; f(x)\int dy\, p(y\mid x) \;=\; f(x),
\]</span></p>
<p>luego <span class="math inline">\(f\)</span> es estacionaria.</p>
</section>
<section id="construcción-mh" class="level2">
<h2 class="anchored" data-anchor-id="construcción-mh">Construcción MH</h2>
<p>Un truco llamado <strong>Metropolis–Hastings</strong> logra este balance detallado. Empezamos con una distribución <span class="math inline">\(q(y\mid x)\)</span> de la cual sea fácil tomar muestras. Con ella seguimos los siguientes pasos:</p>
<ol type="1">
<li><p>Tomamos una muestra <span class="math inline">\(Y\)</span> sacada de <span class="math inline">\(q(y\mid x)\)</span> y calculamos la siguiente función de probabilidad <span class="math display">\[
r(x,y)=\min\!\left\{1,\;\frac{f(y)\,q(x\mid y)}{f(x)\,q(y\mid x)}\right\}.
\]</span></p>
<p>Tiene una forma un poco extraña pero veremos en un segundo que el numerador del segundo término está puesto para lograr el balance detallado.</p></li>
<li><p>Con probabilidad <span class="math inline">\(r\)</span> acepta el salto <span class="math inline">\(x\to y\)</span> (es decir, tomo <span class="math inline">\(X_{i+1}=Y\)</span>); con probabilidad <span class="math inline">\(1-r\)</span> <strong>rechaza</strong> (es decir, el punto es igual que el anterior <span class="math inline">\(X_{i+1}=x\)</span>).</p></li>
</ol>
<p><strong>Por qué funciona (intuición).</strong></p>
<p>Para entender por qué funciona, consideremos el caso <span class="math inline">\(f(x)\,q(y\mid x) &gt; f(y)\,q(x\mid y)\)</span>, entonces <span class="math display">\[
r(x, y) = \frac{f(y)\,q(x\mid y)}{f(x)\,q(y\mid x)}\,,\quad r(y,x)=1\,.
\]</span></p>
<p>Con esto podemos calcular la probabilidad de saltar de <span class="math inline">\(x\)</span> a <span class="math inline">\(y\)</span>, que está dada por la probabilidad de saltar al valor <span class="math inline">\(y\)</span> de la distribución <span class="math inline">\(q(y\mid x)\)</span> multiplicada por la probabilidad de aceptar ese salto</p>
<p><span class="math display">\[
p(x \mid y)=q(x\mid y)\, r(x,y)
= \frac{f(y)\,q(x\mid y)}{f(x)}
\]</span></p>
<p>mientras que</p>
<p><span class="math display">\[
p(y\mid x)=q(y\mid x)\, r(y,x) = q(x\mid y),
\]</span></p>
<p>Comparando estas dos ecuaciones obtenemos</p>
<p><span class="math display">\[
f(x)\,p(x\mid y) = f(y)\,q(x\mid y) = f(y)\,p(y\mid x)\,,
\]</span></p>
<p>que es el balance detallado.</p>
<section id="propuesta-gaussiana" class="level3">
<h3 class="anchored" data-anchor-id="propuesta-gaussiana">Propuesta gaussiana</h3>
<p>Una elección común es tomar <span class="math inline">\(q(y\mid x)\)</span> como una gaussiana con media <span class="math inline">\(x\)</span> y varianza <span class="math inline">\(b^2\)</span> (donde <span class="math inline">\(b\)</span> es algún valor escogido de antemano). Esta distribución es simétrica <span class="math inline">\(q(y\mid x) = q(x\mid y)\)</span> tal que parte del algoritmo se simplifica <span class="math display">\[
r(x,y)=\min\!\left\{1,\; \frac{f(y)}{f(x)}\right\}.
\]</span></p>
<p>El parámetro <span class="math inline">\(b\)</span> controla el tamaño de paso, y debemos considerar que</p>
<ul>
<li><strong>b muy pequeño:</strong> la cadena avanza en pasos diminutos y explora muy lentamente.</li>
<li><strong>b muy grande:</strong> muchos intentos caen en colas y se <strong>rechazan</strong>; la cadena se “atasca”.</li>
</ul>
<p>Una regla práctica en 1–3 dimensiones es ajustar <span class="math inline">\(b\)</span> para aceptar aproximadamente <strong>50 %</strong> de los saltos.</p>
<p>Una referencia útil para el uso de este tipo de integración en la práctica es la documentación de las librerías <a href="https://docs.pymc.io/en/stable/">PyMC</a> y <a href="https://emcee.readthedocs.io/en/stable/">emcee</a>.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/jorgenorena\.github\.io\/metodos-numericos-sitio\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>